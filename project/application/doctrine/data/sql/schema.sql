CREATE TABLE post (id BIGINT AUTO_INCREMENT, title VARCHAR(255), content TEXT, user_id BIGINT NOT NULL, type BIGINT, created_at DATETIME, updated_at DATETIME, deleted TINYINT(1) DEFAULT 0 NOT NULL, slug VARCHAR(255), UNIQUE INDEX sluggable_idx (slug), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE usergroup_user (user_id BIGINT, user_group_id BIGINT, PRIMARY KEY(user_id, user_group_id)) ENGINE = INNODB;
CREATE TABLE media (id BIGINT AUTO_INCREMENT, filename TEXT, description TEXT, user_id BIGINT NOT NULL, type VARCHAR(255), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE media (id BIGINT AUTO_INCREMENT, filename TEXT, description TEXT, user_id BIGINT NOT NULL, type VARCHAR(255), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE media_tag (tag_id BIGINT, media_id BIGINT, PRIMARY KEY(tag_id, media_id)) ENGINE = INNODB;
CREATE TABLE post (id BIGINT AUTO_INCREMENT, title VARCHAR(255), content TEXT, user_id BIGINT NOT NULL, type BIGINT, created_at DATETIME, updated_at DATETIME, deleted TINYINT(1) DEFAULT 0 NOT NULL, slug VARCHAR(255), UNIQUE INDEX sluggable_idx (slug), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE post (id BIGINT AUTO_INCREMENT, title VARCHAR(255), content TEXT, user_id BIGINT NOT NULL, type BIGINT, created_at DATETIME, updated_at DATETIME, deleted TINYINT(1) DEFAULT 0 NOT NULL, slug VARCHAR(255), UNIQUE INDEX sluggable_idx (slug), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE post_media (post_id BIGINT, media_id BIGINT, PRIMARY KEY(post_id, media_id)) ENGINE = INNODB;
CREATE TABLE post_tag (tag_id BIGINT, post_id BIGINT, PRIMARY KEY(tag_id, post_id)) ENGINE = INNODB;
CREATE TABLE tag (id BIGINT AUTO_INCREMENT, name VARCHAR(255), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE user (id BIGINT AUTO_INCREMENT, username VARCHAR(255), deleted TINYINT(1) DEFAULT 0 NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE user_group (id BIGINT AUTO_INCREMENT, name VARCHAR(255), deleted TINYINT(1) DEFAULT 0 NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE media (id BIGINT AUTO_INCREMENT, filename TEXT, description TEXT, user_id BIGINT NOT NULL, type VARCHAR(255), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
ALTER TABLE post ADD FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE usergroup_user ADD FOREIGN KEY (user_id) REFERENCES user(id) ON DELETE CASCADE;
ALTER TABLE usergroup_user ADD FOREIGN KEY (user_group_id) REFERENCES user_group(id) ON DELETE CASCADE;
ALTER TABLE media ADD FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE media ADD FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE media_tag ADD FOREIGN KEY (tag_id) REFERENCES tag(id) ON DELETE CASCADE;
ALTER TABLE media_tag ADD FOREIGN KEY (media_id) REFERENCES media(id) ON DELETE CASCADE;
ALTER TABLE post ADD FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE post ADD FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE post_media ADD FOREIGN KEY (post_id) REFERENCES post(id) ON DELETE CASCADE;
ALTER TABLE post_media ADD FOREIGN KEY (media_id) REFERENCES media(id) ON DELETE CASCADE;
ALTER TABLE post_tag ADD FOREIGN KEY (tag_id) REFERENCES tag(id) ON DELETE CASCADE;
ALTER TABLE post_tag ADD FOREIGN KEY (post_id) REFERENCES post(id) ON DELETE CASCADE;
ALTER TABLE media ADD FOREIGN KEY (user_id) REFERENCES user(id);
